<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ— æ²¹å‹ç¼©æœºæ€§èƒ½è®¡ç®—å™¨ v8.29 (MVR Superheat Input)</title>
    <style>
        .sub-tab-btn.active {
            background-color: #059669;
            color: white;
            border-color: #059669;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
  <script type="module" crossorigin src="/Calculation-of-Compressor-Efficiency-pro/assets/index-BiTvBkRG.js"></script>
  <link rel="stylesheet" crossorigin href="/Calculation-of-Compressor-Efficiency-pro/assets/index-CNKn54tI.css">
</head>

<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-7xl p-4">

        <header class="text-center py-6 mb-4 bg-white rounded-lg shadow-md no-print">
            <h1 class="text-4xl font-bold text-teal-800">æ— æ²¹å‹ç¼©æœºæ€§èƒ½è®¡ç®—å™¨</h1>
            <p class="text-lg text-gray-600 mt-2">v8.29 (MVR Suction Superheat Input)</p>
        </header>

        <div class="bg-white rounded-lg shadow-md no-print">

            <nav class="flex border-b border-gray-300 overflow-x-auto">
                <button id="tab-btn-1"
                    class="tab-btn flex-1 py-4 px-6 text-center text-gray-600 hover:text-gray-800 transition-all duration-200 active whitespace-nowrap"><span
                        class="text-xl">â‘ </span> åˆ¶å†·/CO2çƒ­æ³µ</button>
                <button id="tab-btn-2"
                    class="tab-btn flex-1 py-4 px-6 text-center text-gray-600 hover:text-gray-800 transition-all duration-200 whitespace-nowrap"><span
                        class="text-xl">â‘¡</span> æ°”ä½“å‹ç¼© (Gas)</button>
                <button id="tab-btn-3"
                    class="tab-btn flex-1 py-4 px-6 text-center text-gray-600 hover:text-gray-800 transition-all duration-200 whitespace-nowrap"><span
                        class="text-xl">â‘¢</span> ç©ºå‹æœº (Air)</button>
                <button id="tab-btn-4"
                    class="tab-btn flex-1 py-4 px-6 text-center text-gray-600 hover:text-gray-800 transition-all duration-200 whitespace-nowrap"><span
                        class="text-xl">â‘£</span> MVR (å®¹ç§¯)</button>
                <button id="tab-btn-5"
                    class="tab-btn flex-1 py-4 px-6 text-center text-gray-600 hover:text-gray-800 transition-all duration-200 whitespace-nowrap"><span
                        class="text-xl">â‘¤</span> MVR (é€å¹³)</button>
            </nav>

            <div class="p-6 md:p-8">

                <!-- ================================================================= -->
                <!-- TAB 1: åˆ¶å†·/CO2 (Standard & Transcritical) -->
                <!-- ================================================================= -->
                <div id="tab-content-1" class="tab-content">

                    <div class="flex justify-center space-x-4 mb-6 border-b pb-4">
                        <button id="sub-tab-std"
                            class="sub-tab-btn active px-6 py-2 rounded-full border border-gray-300 font-bold transition-colors">
                            â„ï¸ å¸¸è§„åˆ¶å†·/çƒ­æ³µ (Standard)
                        </button>
                        <button id="sub-tab-co2"
                            class="sub-tab-btn px-6 py-2 rounded-full border border-gray-300 font-bold transition-colors">
                            ğŸ”¥ CO2 (R744) å¾ªç¯ (Cycle)
                        </button>
                    </div>

                    <!-- 1.1 Standard Heat Pump -->
                    <div id="panel-m1-std">
                        <form id="calc-form-1" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div>
                                <h2 class="text-2xl font-semibold text-green-700 mb-4 border-b pb-2">1. å¾ªç¯å‚æ•° (Cycle)
                                </h2>
                                <div class="input-group">
                                    <label class="block text-sm font-medium text-gray-700">å·¥è´¨ (Refrigerant)</label>
                                    <select id="fluid_m1" name="fluid_m1"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md">
                                        <option value="R134a">R134a</option>
                                        <option value="R245fa">R245fa</option>
                                        <option value="R1234ze(Z)">R1234ze(Z)</option>
                                        <option value="R1233zd(E)">R1233zd(E)</option>
                                        <option value="R1234yf">R1234yf</option>
                                        <option value="R290">R290 (Propane)</option>
                                        <option value="R600a">R600a (Isobutane)</option>
                                        <option value="R717">R717 (Ammonia)</option>
                                        <option value="R410A">R410A</option>
                                        <option value="R507A">R507A</option>
                                        <option value="R22">R22</option>
                                    </select>
                                </div>
                                <div id="fluid-info-m1"
                                    class="mt-2 mb-4 p-3 bg-gray-50 rounded text-sm text-gray-700 min-h-[60px]">---
                                </div>

                                <div class="grid grid-cols-2 gap-x-4 bg-green-50 p-3 rounded mb-2">
                                    <div class="input-group"><label class="text-sm font-bold text-green-800">è’¸å‘æ¸©åº¦
                                            (Â°C)</label><input type="number" name="T_evap_m1" value="5" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                    <div class="input-group"><label class="text-sm font-bold text-green-800">è¿‡çƒ­åº¦
                                            (K)</label><input type="number" name="SH_m1" value="5" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                </div>
                                <div class="grid grid-cols-2 gap-x-4 bg-red-50 p-3 rounded">
                                    <div class="input-group"><label class="text-sm font-bold text-red-800">å†·å‡æ¸©åº¦
                                            (Â°C)</label><input type="number" name="T_cond_m1" value="50" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                    <div class="input-group"><label class="text-sm font-bold text-red-800">è¿‡å†·åº¦
                                            (K)</label><input type="number" name="SC_m1" value="5" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                </div>

                                <div class="mt-2 input-group bg-yellow-50 p-2 rounded border border-yellow-100">
                                    <label class="text-sm font-bold text-gray-700">çº§æ•° (Compression Stages)</label>
                                    <input type="number" name="stages_m1" value="1" step="1" min="1" max="10"
                                        class="w-full border-gray-300 rounded px-2 py-1 mt-1">
                                    <div class="text-[10px] text-gray-500 mt-1">* å¤šçº§å‹ç¼©æŒ‰ç­‰å‹æ¯”åˆ†é… (Equal Pressure Ratio)
                                    </div>
                                </div>

                                <hr class="my-4">
                                <div class="input-group bg-blue-50 p-2 rounded border border-blue-200">
                                    <label class="block text-xs font-bold text-blue-800 mb-1">ğŸ¤– AI æ•ˆç‡é¢„è®¾</label>
                                    <select id="ai_eff_m1"
                                        class="block w-full text-sm border-blue-300 rounded text-blue-700 mb-2">
                                        <option value="">-- é€‰æ‹©å‹ç¼©æœºç±»å‹ --</option>
                                        <option value="scroll">æ— æ²¹æ¶¡æ—‹ (Isen: 70%)</option>
                                        <option value="piston">å¾€å¤æ´»å¡ (Isen: 75%)</option>
                                        <option value="screw">æ— æ²¹èºæ† (Isen: 78%)</option>
                                        <option value="centrifugal">ç¦»å¿ƒå¼ (Isen: 82%)</option>
                                    </select>
                                    <div class="flex items-center mt-2">
                                        <input id="enable_dynamic_eff_m1" name="enable_dynamic_eff_m1" type="checkbox"
                                            class="h-4 w-4 text-green-600 rounded" checked>
                                        <label for="enable_dynamic_eff_m1"
                                            class="ml-2 text-xs font-bold text-gray-700">å¯ç”¨å‹æ¯”ä¿®æ­£ (Simple)</label>
                                    </div>
                                    <div id="dynamic-eff-inputs-m1" class="grid grid-cols-2 gap-x-2 mt-2">
                                        <div class="input-group"><label class="text-xs">è®¾è®¡å‹æ¯” (PR_des)</label><input
                                                type="number" id="pr_design_m1" name="pr_design_m1" value="3.0"
                                                step="0.01" class="w-full text-sm border-gray-300 rounded"></div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-x-4 mt-2">
                                    <div class="input-group"><label class="text-sm">ç­‰ç†µæ•ˆç‡ (%)</label><input type="number"
                                            id="eff_isen_m1" name="eff_isen_m1" value="70" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded"></div>
                                    <div class="input-group"><label class="text-sm">å®¹ç§¯æ•ˆç‡ (%)</label><input type="number"
                                            id="vol_eff_m1" name="vol_eff_m1" value="95" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded"></div>
                                </div>
                                <div class="input-group mt-2"><label class="text-sm">ç”µæœºæ•ˆç‡ (%)</label><input
                                        type="number" id="motor_eff_m1" name="motor_eff_m1" value="95" step="0.01"
                                        class="mt-1 block w-full border-gray-300 rounded"></div>
                            </div>

                            <div>
                                <h2 class="text-2xl font-semibold text-green-700 mb-4 border-b pb-2">2. æµé‡é…ç½® (Flow)</h2>
                                <div class="mb-3">
                                    <div class="flex space-x-4 text-sm">
                                        <label><input type="radio" name="flow_mode_m1" value="rpm" checked>
                                            è½¬é€Ÿ/æ’é‡</label>
                                        <label><input type="radio" name="flow_mode_m1" value="mass"> è´¨é‡æµé‡</label>
                                        <label><input type="radio" name="flow_mode_m1" value="vol"> ä½“ç§¯æµé‡</label>
                                    </div>
                                </div>
                                <div id="flow-inputs-rpm-m1" class="grid grid-cols-2 gap-x-4">
                                    <div class="input-group"><label class="text-sm">è½¬é€Ÿ (RPM)</label><input type="number"
                                            name="rpm_m1" value="3000" step="1"
                                            class="w-full border-gray-300 rounded px-2 py-1"></div>
                                    <div class="input-group"><label class="text-sm">æ’é‡ (cmÂ³)</label><input type="number"
                                            name="vol_disp_m1" value="500" step="0.01"
                                            class="w-full border-gray-300 rounded px-2 py-1"></div>
                                </div>
                                <div id="flow-inputs-mass-m1" class="hidden"><label class="text-sm">è´¨é‡æµé‡
                                        (kg/s)</label><input type="number" name="mass_flow_m1" value="1.0" step="0.001"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div id="flow-inputs-vol-m1" class="hidden"><label class="text-sm">å¸æ°”ä½“ç§¯æµé‡
                                        (mÂ³/h)</label><input type="number" name="vol_flow_m1" value="100" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>

                                <div class="mt-8"><button type="submit" id="calc-button-1"
                                        class="w-full bg-green-600 text-white font-bold py-3 rounded hover:bg-green-700">è®¡ç®—å¸¸è§„çƒ­æ³µ</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- 1.2 CO2 Heat Pump -->
                    <div id="panel-m1-co2" class="hidden">
                        <form id="calc-form-1-co2" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div>
                                <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b border-gray-400 pb-2">1.
                                    CO2 (R744) å¾ªç¯å‚æ•°</h2>
                                <div class="input-group">
                                    <label class="block text-sm font-medium text-gray-700">å·¥è´¨ (Fluid)</label>
                                    <select name="fluid_m1_co2"
                                        class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-gray-100 rounded-md cursor-not-allowed">
                                        <option value="R744">R744 (Carbon Dioxide)</option>
                                    </select>
                                </div>
                                <div id="fluid-info-m1-co2"
                                    class="mt-2 mb-4 p-3 bg-gray-50 rounded text-sm text-gray-700 min-h-[60px]">R744
                                    ä¸´ç•Œå‚æ•°: 31.06Â°C / 73.8 bar</div>

                                <div
                                    class="grid grid-cols-2 gap-x-4 bg-green-50 p-3 rounded mb-2 border border-green-100">
                                    <div class="input-group"><label class="text-sm font-bold text-green-800">è’¸å‘æ¸©åº¦
                                            (Â°C)</label><input type="number" name="T_evap_m1_co2" value="-5" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                    <div class="input-group"><label class="text-sm font-bold text-green-800">è¿‡çƒ­åº¦
                                            (K)</label><input type="number" name="SH_m1_co2" value="5" step="0.01"
                                            class="mt-1 block w-full border-gray-300 rounded px-2 py-1"></div>
                                </div>

                                <div class="mb-2 mt-4">
                                    <label class="block text-sm font-bold text-gray-700 mb-2">å¾ªç¯ç±»å‹ (Cycle Mode)</label>
                                    <div class="flex space-x-4 text-sm">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="cycle_type_m1_co2" value="transcritical" checked
                                                class="mr-1 text-orange-600">
                                            <span class="text-orange-700 font-bold">è·¨ä¸´ç•Œ (Transcritical)</span>
                                        </label>
                                        <label class="flex items-center cursor-pointer">
                                            <input type="radio" name="cycle_type_m1_co2" value="subcritical"
                                                class="mr-1 text-blue-600">
                                            <span class="text-blue-700 font-bold">äºšä¸´ç•Œ (Subcritical)</span>
                                        </label>
                                    </div>
                                </div>

                                <div id="inputs-transcritical-m1-co2"
                                    class="bg-orange-50 p-3 rounded border border-orange-100 animate-fade-in">
                                    <div class="flex justify-between items-center mb-1">
                                        <label class="text-sm font-bold text-orange-800">æ°”ä½“å†·å´å‚æ•° (Gas Cooler)</label>
                                        <button type="button" id="btn-opt-p-high"
                                            class="text-xs bg-orange-200 hover:bg-orange-300 text-orange-800 px-2 py-0.5 rounded transition">âš¡
                                            æ¨è P_opt</button>
                                    </div>
                                    <div class="grid grid-cols-2 gap-x-4">
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">å‡ºå£æ¸©åº¦ T_out (Â°C)</label>
                                            <input type="number" id="T_gc_out_m1_co2" name="T_gc_out_m1_co2" value="35"
                                                step="0.01" class="mt-1 block w-full border-gray-300 rounded px-2 py-1">
                                        </div>
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">é«˜å‹ä¾§å‹åŠ› P_high (bar)</label>
                                            <input type="number" id="p_high_m1_co2" name="p_high_m1_co2" value="90"
                                                step="0.01"
                                                class="mt-1 block w-full border-gray-300 rounded px-2 py-1 font-bold text-orange-700">
                                        </div>
                                    </div>
                                </div>

                                <div id="inputs-subcritical-m1-co2"
                                    class="bg-blue-50 p-3 rounded border border-blue-100 animate-fade-in hidden">
                                    <div class="flex justify-between items-center mb-1">
                                        <label class="text-sm font-bold text-blue-800">å†·å‡å‚æ•° (Condenser)</label>
                                    </div>
                                    <div class="grid grid-cols-2 gap-x-4">
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">å†·å‡æ¸©åº¦ T_cond (Â°C)</label>
                                            <input type="number" id="T_cond_m1_co2" name="T_cond_m1_co2" value="15"
                                                max="30" step="0.01"
                                                class="mt-1 block w-full border-gray-300 rounded px-2 py-1 font-bold text-blue-700">
                                        </div>
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">è¿‡å†·åº¦ SC (K)</label>
                                            <input type="number" name="SC_m1_co2" value="3" step="0.01"
                                                class="mt-1 block w-full border-gray-300 rounded px-2 py-1">
                                        </div>
                                    </div>
                                    <div class="text-[10px] text-blue-500 mt-1">* å¿…é¡»å°äºä¸´ç•Œç‚¹ (31.06Â°C). é»˜è®¤å€¼å·²ä¼˜åŒ–ä¾¿äºæµ‹è¯•.</div>
                                </div>

                                <hr class="my-4">

                                <div class="input-group bg-gray-50 p-3 rounded border border-gray-200 mb-4">
                                    <div class="flex justify-between"><label
                                            class="block text-sm font-bold text-gray-800 mb-2">âš™ï¸ ç‰©ç†æ•ˆç‡æ¨¡å‹ (Physical
                                            Efficiency)</label><select id="ai_eff_m1_co2"
                                            class="text-xs border-gray-300 rounded h-6">
                                            <option value="">AI é¢„è®¾...</option>
                                            <option value="co2_rotary">CO2 è½¬å­ (çƒ­æ°´å™¨)</option>
                                            <option value="co2_piston">CO2 æ´»å¡ (å•†ç”¨å†·å†»)</option>
                                        </select></div>
                                    <div class="grid grid-cols-2 gap-x-4 gap-y-2">
                                        <div class="input-group"><label class="text-xs">å³°å€¼ç­‰ç†µæ•ˆç‡ (Peak Isen)</label><input
                                                type="number" id="eff_isen_peak_m1_co2" name="eff_isen_peak_m1_co2"
                                                value="0.70" step="0.01" class="w-full text-sm border-gray-300 rounded">
                                        </div>
                                        <div class="input-group"><label class="text-xs">è®¾è®¡å‹æ¯” (PR_design)</label><input
                                                type="number" id="pr_design_m1_co2" name="pr_design_m1_co2" value="3.5"
                                                step="0.01" class="w-full text-sm border-gray-300 rounded"></div>
                                        <div class="input-group"><label class="text-xs">ä½™éš™ç³»æ•° (Clearance C)</label><input
                                                type="number" id="clearance_m1_co2" name="clearance_m1_co2" value="0.05"
                                                step="0.001" class="w-full text-sm border-gray-300 rounded"></div>
                                        <div class="input-group"><label class="text-xs">å¤šå˜æŒ‡æ•° (Index n)</label><input
                                                type="number" id="poly_index_m1_co2" name="poly_index_m1_co2"
                                                value="1.3" step="0.01" class="w-full text-sm border-gray-300 rounded">
                                        </div>
                                    </div>
                                </div>

                                <div class="input-group bg-red-50 p-3 rounded border border-red-100">
                                    <label class="block text-sm font-bold text-red-800 mb-2">ğŸŒ¡ï¸ çƒ­ç®¡ç†ä¸å†·å´ (Thermal
                                        Mgmt)</label>

                                    <div class="flex space-x-3 text-xs mb-3">
                                        <label class="flex items-center cursor-pointer"><input type="radio"
                                                name="cooling_mode_m1_co2" value="adiabatic" checked class="mr-1">
                                            <span>æ—  (ç»çƒ­)</span></label>
                                        <label class="flex items-center cursor-pointer"><input type="radio"
                                                name="cooling_mode_m1_co2" value="surface" class="mr-1">
                                            <span>è¡¨é¢å†·å´</span></label>
                                        <label class="flex items-center cursor-pointer"><input type="radio"
                                                name="cooling_mode_m1_co2" value="injection" class="mr-1">
                                            <span>å–·æ¶²å†·å´</span></label>
                                    </div>

                                    <div id="surface_inputs_m1_co2" class="hidden animate-fade-in">
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">æœºå£³æ•£çƒ­æ¯”ä¾‹ Heat Loss (%)</label>
                                            <input type="number" name="heat_loss_ratio_m1_co2" value="15" step="0.01"
                                                class="mt-1 w-full border-gray-300 rounded px-2 py-1 text-sm">
                                        </div>
                                    </div>

                                    <div id="injection_inputs_m1_co2" class="hidden animate-fade-in">
                                        <div class="input-group">
                                            <label class="text-xs text-gray-600">ç›®æ ‡æ’æ°”æ¸©åº¦ Target T_dis (Â°C)</label>
                                            <input type="number" name="target_t_out_m1_co2" value="120" step="0.01"
                                                class="mt-1 w-full border-gray-300 rounded px-2 py-1 text-sm font-bold text-red-600">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div>
                                <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b border-gray-400 pb-2">2.
                                    æµé‡é…ç½® (Flow)</h2>
                                <div class="mb-3">
                                    <div class="flex space-x-4 text-sm">
                                        <label><input type="radio" name="flow_mode_m1_co2" value="rpm" checked>
                                            è½¬é€Ÿ/æ’é‡</label>
                                        <label><input type="radio" name="flow_mode_m1_co2" value="mass"> è´¨é‡æµé‡</label>
                                        <label><input type="radio" name="flow_mode_m1_co2" value="vol"> ä½“ç§¯æµé‡</label>
                                    </div>
                                </div>
                                <div id="flow-inputs-rpm-m1_co2" class="grid grid-cols-2 gap-x-4">
                                    <div class="input-group"><label class="text-sm">è½¬é€Ÿ (RPM)</label><input type="number"
                                            name="rpm_m1_co2" value="4500" step="1"
                                            class="w-full border-gray-300 rounded px-2 py-1"></div>
                                    <div class="input-group"><label class="text-sm">æ’é‡ (cmÂ³)</label><input type="number"
                                            name="vol_disp_m1_co2" value="15" step="0.01"
                                            class="w-full border-gray-300 rounded px-2 py-1"></div>
                                </div>
                                <div id="flow-inputs-mass-m1_co2" class="hidden"><label class="text-sm">è´¨é‡æµé‡
                                        (kg/s)</label><input type="number" name="mass_flow_m1_co2" value="0.1"
                                        step="0.001" class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div id="flow-inputs-vol-m1_co2" class="hidden"><label class="text-sm">å¸æ°”ä½“ç§¯æµé‡
                                        (mÂ³/h)</label><input type="number" name="vol_flow_m1_co2" value="5" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>

                                <div class="mt-8">
                                    <button type="submit" id="calc-button-1-co2"
                                        class="w-full bg-gray-800 text-white font-bold py-3 rounded hover:bg-gray-900 border-2 border-orange-500">
                                        ğŸ”¥ è®¡ç®— CO2 (R744) å¾ªç¯
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="mt-8">
                        <div id="results-1" class="bg-white border p-4 rounded min-h-[200px]">--- ç»“æœåŒº (Results) ---
                        </div>
                        <div id="chart-m1" class="chart-container hidden"></div>

                        <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center">
                            <button type="button" id="print-button-1"
                                class="w-full md:w-auto bg-gray-800 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-900 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ–¨ï¸ æ‰“å°æŠ€æœ¯è§„æ ¼ä¹¦
                            </button>
                            <button type="button" id="export-button-1"
                                class="w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ“Š å¯¼å‡º Excel
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ================================================================= -->
                <!-- TAB 2: æ°”ä½“å‹ç¼© (Gas) -->
                <!-- ================================================================= -->
                <div id="tab-content-2" class="tab-content" style="display: none;">
                    <form id="calc-form-2" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                        <div>
                            <h2 class="text-2xl font-semibold text-cyan-700 mb-4 border-b pb-2">1. æ°”ä½“å‚æ•° (Gas Params)
                            </h2>
                            <div class="input-group">
                                <label class="block text-sm">å·¥è´¨ (Gas)</label>
                                <select id="fluid_m2" name="fluid_m2" class="w-full border-gray-300 rounded px-2 py-1">
                                    <option value="Air">Air (ç©ºæ°”)</option>
                                    <option value="Nitrogen">Nitrogen (æ°®æ°”)</option>
                                    <option value="Oxygen">Oxygen (æ°§æ°”)</option>
                                    <option value="Argon">Argon (æ°©æ°”)</option>
                                    <option value="Hydrogen">Hydrogen (æ°¢æ°”)</option>
                                    <option value="Helium">Helium (æ°¦æ°”)</option>
                                    <option value="Methane">Methane (ç”²çƒ·)</option>
                                </select>
                            </div>
                            <div id="fluid-info-m2" class="mt-2 mb-2 p-2 bg-gray-50 rounded text-xs min-h-[40px]">---
                            </div>
                            <div class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">è¿›å£å‹åŠ› (bar)</label><input type="number"
                                        name="p_in_m2" value="1.013" step="0.001"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">è¿›å£æ¸©åº¦ (Â°C)</label><input type="number"
                                        name="T_in_m2" value="20" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div class="input-group"><label class="text-sm">å‡ºå£å‹åŠ› (bar)</label><input type="number"
                                    name="p_out_m2" value="8.0" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>

                            <div
                                class="grid grid-cols-2 gap-x-4 mt-2 bg-yellow-50 p-2 rounded border border-yellow-100">
                                <div class="input-group"><label class="text-sm">å‹ç¼©çº§æ•° (Stages)</label><input
                                        type="number" name="stages_m2" value="1" step="1" min="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="flex items-center mt-6">
                                    <input type="checkbox" name="enable_intercool_m2" id="enable_intercool_m2"
                                        class="h-4 w-4 text-cyan-600">
                                    <label for="enable_intercool_m2" class="ml-2 text-sm text-gray-700">å¯ç”¨çº§é—´å†·å´</label>
                                </div>
                            </div>

                            <div class="input-group bg-blue-50 p-2 rounded border border-blue-200 mt-2">
                                <label class="block text-xs font-bold text-blue-800 mb-1">ğŸ¤– AI æœºå‹æ¨è</label>
                                <select id="ai_eff_m2"
                                    class="block w-full text-sm border-blue-300 rounded text-blue-700">
                                    <option value="">-- Custom --</option>
                                    <option value="piston">å¾€å¤æ´»å¡ (Isen: 75%)</option>
                                    <option value="screw">èºæ†å¼ (Isen: 78%)</option>
                                    <option value="turbo">é€å¹³/ç¦»å¿ƒå¼ (Isen: 82%)</option>
                                </select>
                            </div>

                            <div class="mt-4 pt-2 border-t border-gray-200 bg-cyan-50 p-3 rounded">
                                <label class="block text-sm font-bold text-cyan-800 mb-2">ğŸŒ¡ï¸ çƒ­ç®¡ç† (Thermal Mgmt)</label>
                                <div class="flex space-x-4 text-xs mb-2">
                                    <label class="flex items-center"><input type="radio" name="cooling_mode_m2"
                                            value="adiabatic" checked> <span class="ml-1">ç»çƒ­ (Adiabatic)</span></label>
                                    <label class="flex items-center"><input type="radio" name="cooling_mode_m2"
                                            value="target_t"> <span class="ml-1">é¢„è®¾æ’æ¸© (Target T_out)</span></label>
                                </div>
                                <div id="cooling-inputs-m2" class="hidden">
                                    <div class="input-group">
                                        <label class="text-xs text-gray-600">ç›®æ ‡æ’æ°”æ¸©åº¦ (Â°C)</label>
                                        <input type="number" name="target_t_out_m2" value="100" step="0.1"
                                            class="w-full border-cyan-300 rounded px-2 py-1 text-sm">
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-x-4 mt-2">
                                <div class="input-group"><label class="text-sm">ç­‰ç†µæ•ˆç‡ (%)</label><input type="number"
                                        id="eff_isen_m2" name="eff_isen_m2" value="75" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">å®¹ç§¯æ•ˆç‡ (%)</label><input type="number"
                                        id="vol_eff_m2" name="vol_eff_m2" value="85" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                        </div>
                        <div>
                            <h2 class="text-2xl font-semibold text-cyan-700 mb-4 border-b pb-2">2. æµé‡é…ç½® (Flow)</h2>
                            <div class="mb-3">
                                <div class="flex space-x-4 text-sm">
                                    <label><input type="radio" name="flow_mode_m2" value="rpm" checked> RPM</label>
                                    <label><input type="radio" name="flow_mode_m2" value="mass"> è´¨é‡</label>
                                    <label><input type="radio" name="flow_mode_m2" value="vol"> ä½“ç§¯</label>
                                </div>
                            </div>
                            <div id="flow-inputs-rpm-m2" class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">RPM</label><input type="number"
                                        name="rpm_m2" value="3000" step="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">æ’é‡ (cmÂ³)</label><input type="number"
                                        name="vol_disp_m2" value="500" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div id="flow-inputs-mass-m2" class="hidden"><label class="text-sm">è´¨é‡æµé‡
                                    (kg/s)</label><input type="number" name="mass_flow_m2" value="1.0" step="0.001"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                            <div id="flow-inputs-vol-m2" class="hidden"><label class="text-sm">å¸æ°”ä½“ç§¯æµé‡
                                    (mÂ³/h)</label><input type="number" name="vol_flow_m2" value="100" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>

                            <div class="mt-4 pt-2 border-t">
                                <div class="flex items-center">
                                    <input id="enable_cooler_calc_m2" name="enable_cooler_calc_m2" type="checkbox"
                                        class="h-4 w-4 text-cyan-600">
                                    <label for="enable_cooler_calc_m2" class="ml-2 text-sm text-gray-700">åå†·å´å™¨è®¡ç®—
                                        (Optional)</label>
                                </div>
                                <div id="cooler-inputs-m2" class="mt-2 hidden">
                                    <label class="text-xs text-gray-500">ç›®æ ‡æ¸©åº¦ (Â°C)</label>
                                    <input type="number" name="target_temp_m2" value="40" step="0.01"
                                        class="w-full text-sm border-gray-300 rounded">
                                </div>
                            </div>

                            <div class="mt-8"><button type="submit" id="calc-button-2"
                                    class="w-full bg-cyan-600 text-white font-bold py-3 rounded hover:bg-cyan-700">è®¡ç®—æ°”ä½“å‹ç¼©</button>
                            </div>
                        </div>
                    </form>
                    <div class="mt-8">
                        <div id="results-2" class="bg-white border p-4 rounded min-h-[200px]">--- ç»“æœåŒº (Results) ---
                        </div>
                        <div id="chart-m2" class="chart-container hidden"></div>
                        <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center">
                            <button type="button" id="print-button-2"
                                class="w-full md:w-auto bg-gray-800 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-900 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ–¨ï¸ æ‰“å°æŠ€æœ¯è§„æ ¼ä¹¦
                            </button>
                            <button type="button" id="export-button-2"
                                class="w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ“Š å¯¼å‡º Excel
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ================================================================= -->
                <!-- TAB 3: ç©ºå‹æœº (Air Compressor) v8.28 Modified -->
                <!-- ================================================================= -->
                <div id="tab-content-3" class="tab-content" style="display: none;">
                    <form id="calc-form-3" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                        <div>
                            <h2 class="text-2xl font-semibold text-cyan-700 mb-4 border-b pb-2">1. æ¹¿ç©ºæ°”å‚æ•° (Air Params)
                            </h2>
                            <div class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">P_in (bar)</label><input type="number"
                                        name="p_in_m3" value="1.013" step="0.001"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">T_in (Â°C)</label><input type="number"
                                        name="T_in_m3" value="20" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">æ¹¿åº¦ RH (%)</label><input type="number"
                                        name="RH_in_m3" value="60" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">P_out (bar)</label><input type="number"
                                        name="p_out_m3" value="8.0" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>

                            <!-- Multi-Stage -->
                            <div
                                class="grid grid-cols-2 gap-x-4 mt-2 bg-yellow-50 p-2 rounded border border-yellow-100">
                                <div class="input-group"><label class="text-sm">å‹ç¼©çº§æ•° (Stages)</label><input
                                        type="number" name="stages_m3" value="1" step="1" min="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="flex items-center mt-6">
                                    <input type="checkbox" name="enable_intercool_m3" id="enable_intercool_m3"
                                        class="h-4 w-4 text-cyan-600">
                                    <label for="enable_intercool_m3" class="ml-2 text-sm text-gray-700">å¯ç”¨çº§é—´å†·å´</label>
                                </div>
                            </div>

                            <!-- AI Recommend -->
                            <div class="input-group bg-blue-50 p-2 rounded border border-blue-200 mt-2">
                                <label class="block text-xs font-bold text-blue-800 mb-1">ğŸ¤– AI æ¨è</label>
                                <select id="ai_eff_m3"
                                    class="block w-full text-sm border-blue-300 rounded text-blue-700">
                                    <option value="">-- æœºå‹ --</option>
                                    <option value="piston_water">æ°´å†·æ´»å¡ (Isen: 72%, Vol: 85%)</option>
                                    <option value="screw_oil_free">å¹²å¼èºæ† (Isen: 70%, Vol: 90%)</option>
                                    <option value="turbo">ç¦»å¿ƒ/é€å¹³å¼ (Turbo) (Isen: 82%)</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-2 gap-x-4 mt-2">
                                <div class="input-group"><label class="text-sm">ç­‰ç†µæ•ˆç‡ (%)</label><input type="number"
                                        id="eff_isen_m3" name="eff_isen_m3" value="75" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">å®¹ç§¯æ•ˆç‡ (%)</label><input type="number"
                                        id="vol_eff_m3" name="vol_eff_m3" value="90" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                        </div>
                        <div>
                            <h2 class="text-2xl font-semibold text-cyan-700 mb-4 border-b pb-2">2. æµé‡ä¸å†·å´ (Flow &
                                Cooling)</h2>
                            <div class="mb-3">
                                <div class="flex space-x-4 text-sm">
                                    <label><input type="radio" name="flow_mode_m3" value="rpm" checked> è½¬é€Ÿ/æ’é‡</label>
                                    <label><input type="radio" name="flow_mode_m3" value="mass"> è´¨é‡æµé‡</label>
                                    <label><input type="radio" name="flow_mode_m3" value="vol"> ä½“ç§¯æµé‡</label>
                                </div>
                            </div>
                            <div id="flow-inputs-rpm-m3" class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">RPM</label><input type="number"
                                        name="rpm_m3" value="1500" step="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">æ’é‡ (cmÂ³)</label><input type="number"
                                        name="vol_disp_m3" value="1000" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div id="flow-inputs-mass-m3" class="hidden"><label class="text-sm">è´¨é‡æµé‡
                                    (kg/s)</label><input type="number" name="mass_flow_m3" value="0.5" step="0.001"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                            <div id="flow-inputs-vol-m3" class="hidden"><label class="text-sm">ä½“ç§¯æµé‡ (mÂ³/h)</label><input
                                    type="number" name="vol_flow_m3" value="600" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>

                            <div class="mt-4 border-t pt-2">
                                <label class="block text-sm font-bold mb-2 text-cyan-800">å†·å´æ–¹å¼ (Cooling)</label>
                                <div class="space-y-2">
                                    <label class="flex items-center"><input type="radio" name="cooling_type_m3"
                                            value="adiabatic" checked> <span class="ml-2 text-sm">ç»çƒ­
                                            (Adiabatic)</span></label>
                                    <label class="flex items-center"><input type="radio" name="cooling_type_m3"
                                            value="jacket"> <span class="ml-2 text-sm">å¤¹å¥—æ°´å†· (Jacket
                                            Cooling)</span></label>
                                    <label class="flex items-center"><input type="radio" name="cooling_type_m3"
                                            value="injection"> <span class="ml-2 text-sm font-bold text-blue-600">å–·æ°´å†·å´
                                            (Water Injection)</span></label>
                                </div>

                                <div id="jacket-inputs-m3" class="mt-2 hidden bg-gray-50 p-2 rounded animate-fade-in">
                                    <label class="text-xs">å¤¹å¥—å¸¦èµ°çƒ­é‡æ¯”ä¾‹ (%)</label>
                                    <input type="number" name="jacket_heat_percent_m3" value="15" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1">
                                </div>

                                <!-- v8.28 Injection Inputs -->
                                <div id="injection-inputs-m3"
                                    class="mt-2 hidden bg-blue-50 p-2 rounded border border-blue-200 animate-fade-in">
                                    <div class="grid grid-cols-2 gap-x-2">
                                        <div>
                                            <label class="text-xs font-bold text-blue-800">é¢„æœŸæ’æ¸© (Â°C)</label>
                                            <input type="number" name="target_t_out_m3" value="100" step="0.1"
                                                class="w-full border-blue-300 rounded px-2 py-1 font-bold text-blue-700"
                                                title="Expected Discharge Temp">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">å–·æ°´æ¸©åº¦ (Â°C)</label>
                                            <input type="number" name="T_inject_water_m3" value="25" step="0.1"
                                                class="w-full border-gray-300 rounded px-2 py-1">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-4 pt-2 border-t">
                                <div class="flex items-center">
                                    <input id="enable_cooler_calc_m3" name="enable_cooler_calc_m3" type="checkbox"
                                        class="h-4 w-4 text-cyan-600">
                                    <label for="enable_cooler_calc_m3"
                                        class="ml-2 text-sm text-gray-700 font-bold">åå†·å™¨è®¡ç®— (Aftercooler)</label>
                                </div>
                                <div id="cooler-inputs-m3" class="mt-2 hidden bg-gray-50 p-2 rounded animate-fade-in">
                                    <label class="text-xs text-gray-500">åå†·å™¨å‡ºå£ç›®æ ‡æ¸©åº¦ (Â°C)</label>
                                    <input type="number" name="target_temp_m3" value="40" step="0.01"
                                        class="w-full text-sm border-gray-300 rounded">
                                    <div class="text-[10px] text-gray-400 mt-1">* è‹¥ä½äºéœ²ç‚¹å°†è‡ªåŠ¨è®¡ç®—æå‡ºæ°´é‡</div>
                                </div>
                            </div>
                            <div class="mt-6"><button type="submit" id="calc-button-3"
                                    class="w-full bg-cyan-600 text-white font-bold py-3 rounded hover:bg-cyan-700">è®¡ç®—ç©ºå‹æœº</button>
                            </div>
                        </div>
                    </form>
                    <div class="mt-8">
                        <div id="results-3" class="bg-white border p-4 rounded min-h-[200px]">--- ç»“æœåŒº ---</div>
                        <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center">
                            <button type="button" id="print-button-3"
                                class="w-full md:w-auto bg-gray-800 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-900 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ–¨ï¸ æ‰“å°æŠ€æœ¯è§„æ ¼ä¹¦
                            </button>
                            <button type="button" id="export-button-3"
                                class="w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2"
                                disabled>
                                ğŸ“Š å¯¼å‡º Excel
                            </button>
                        </div>
                    </div>
                </div>

                <div id="tab-content-1" class="tab-content">
                    <div class="p-4 bg-gray-50 text-center text-sm text-gray-500">Mode 1 ä»£ç ä¿æŒ v8.28</div>
                </div>
                <div id="tab-content-2" class="tab-content" style="display:none;">
                    <div class="p-4 bg-gray-50 text-center text-sm text-gray-500">Mode 2 ä»£ç ä¿æŒ v8.28</div>
                </div>
                <div id="tab-content-3" class="tab-content" style="display:none;">
                    <div class="p-4 bg-gray-50 text-center text-sm text-gray-500">Mode 3 ä»£ç ä¿æŒ v8.28</div>
                </div>

                <!-- TAB 4: MVR (å®¹ç§¯å¼) v8.29 Modified -->
                <div id="tab-content-4" class="tab-content" style="display: none;">
                    <form id="calc-form-4" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                        <div>
                            <h2 class="text-2xl font-semibold text-purple-700 mb-4 border-b pb-2">1. è’¸æ±½ MVR å‚æ•°</h2>
                            <div class="input-group">
                                <label class="block text-sm">å·¥è´¨ (é»˜è®¤æ°´è’¸æ±½)</label>
                                <select id="fluid_m4" name="fluid_m4" class="w-full border-gray-300 rounded px-2 py-1">
                                    <option value="Water">Water (Steam)</option>
                                    <option value="R245fa">R245fa (ORC)</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-2 gap-x-4 mt-2">
                                <div class="input-group"><label class="text-sm">å¸æ°”å‹åŠ› (bar)</label><input type="number"
                                        name="p_in_m4" value="1.013" step="0.001"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <!-- Changed: T_in -> SH_in -->
                                <div class="input-group"><label class="text-sm font-bold text-purple-800">å¸æ°”è¿‡çƒ­åº¦
                                        (K)</label><input type="number" name="SH_in_m4" value="0" step="0.1"
                                        class="w-full border-gray-300 rounded px-2 py-1" title="0 for Saturated Steam">
                                </div>
                            </div>
                            <div class="input-group mt-2"><label class="text-sm font-bold text-purple-800">é¥±å’Œæ¸©å‡ Î”T
                                    (K)</label><input type="number" name="delta_T_m4" value="12" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                        </div>
                        <div>
                            <h2 class="text-2xl font-semibold text-purple-700 mb-4 border-b pb-2">2. è®¾å¤‡é€‰å‹ & å‡æ¸©</h2>
                            <div class="input-group bg-blue-50 p-2 rounded border border-blue-200 mb-2">
                                <label class="block text-xs font-bold text-blue-800 mb-1">ğŸ¤– AI æ¨è (MVR)</label>
                                <select id="ai_eff_m4"
                                    class="block w-full text-sm border-blue-300 rounded text-blue-700">
                                    <option value="">-- é€‰æ‹©æœºå‹ --</option>
                                    <option value="roots">ç½—èŒ¨é£æœº (Isen: 60%, Vol: 75%)</option>
                                    <option value="screw_mvr">MVR èºæ† (Isen: 75%, Vol: 85%)</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">ç­‰ç†µæ•ˆç‡ (%)</label><input type="number"
                                        id="eff_isen_m4" name="eff_isen_m4" value="65" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">å®¹ç§¯æ•ˆç‡ (%)</label><input type="number"
                                        id="vol_eff_m4" name="vol_eff_m4" value="80" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>

                            <div class="mt-3 mb-2">
                                <div class="flex space-x-2 text-xs">
                                    <label><input type="radio" name="flow_mode_m4" value="rpm" checked> RPM/æ’é‡</label>
                                    <label><input type="radio" name="flow_mode_m4" value="mass"> è´¨é‡æµé‡</label>
                                    <label><input type="radio" name="flow_mode_m4" value="vol"> ä½“ç§¯æµé‡</label>
                                </div>
                            </div>
                            <div id="flow-inputs-rpm-m4" class="grid grid-cols-2 gap-x-4">
                                <div class="input-group"><label class="text-sm">RPM</label><input type="number"
                                        name="rpm_m4" value="2980" step="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">æ’é‡ (cmÂ³)</label><input type="number"
                                        name="vol_disp_m4" value="10000" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div id="flow-inputs-mass-m4" class="hidden"><label class="text-sm">è’¸å‘é‡ (kg/h)</label><input
                                    type="number" name="mass_flow_m4" value="1000" step="0.001"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                            <div id="flow-inputs-vol-m4" class="hidden"><label class="text-sm">ä½“ç§¯æµé‡ (mÂ³/h)</label><input
                                    type="number" name="vol_flow_m4" value="2000" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>

                            <div class="mt-4 pt-2 border-t border-gray-200 bg-purple-50 p-2 rounded">
                                <div class="flex items-center mb-2">
                                    <input id="enable_desuperheat_m4" name="enable_desuperheat_m4" type="checkbox"
                                        class="h-4 w-4 text-purple-600" checked>
                                    <label for="enable_desuperheat_m4"
                                        class="ml-2 text-sm font-bold text-purple-900">å¯ç”¨å–·æ°´å‡æ¸© (Desuperheating)</label>
                                </div>
                                <div id="desuperheat-inputs-m4">
                                    <div class="grid grid-cols-2 gap-x-4">
                                        <div class="input-group"><label class="text-xs">å–·æ°´æ¸©åº¦ (Â°C)</label><input
                                                type="number" name="T_water_in_m4" value="30" step="0.01"
                                                class="w-full border-gray-300 rounded px-2 py-1 text-sm"></div>
                                        <div class="input-group"><label class="text-xs">ç›®æ ‡è¿‡çƒ­åº¦ (K)</label><input
                                                type="number" name="target_superheat_m4" value="0" step="0.1"
                                                class="w-full border-gray-300 rounded px-2 py-1 text-sm" title="0è¡¨ç¤ºé¥±å’Œ">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-6"><button type="submit" id="calc-button-4"
                                    class="w-full bg-purple-600 text-white font-bold py-3 rounded hover:bg-purple-700">è®¡ç®—
                                    MVR</button></div>
                        </div>
                    </form>
                    <div class="mt-8">
                        <div id="results-4" class="bg-white border p-4 rounded min-h-[200px]">--- ç»“æœåŒº ---</div>
                        <div id="chart-m4" class="chart-container hidden"></div>
                        <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center">
                            <button type="button" id="print-button-4"
                                class="w-full md:w-auto bg-gray-800 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-900 transition duration-300 flex items-center justify-center gap-2"
                                disabled>ğŸ–¨ï¸ æ‰“å°</button>
                            <button type="button" id="export-button-4"
                                class="w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2"
                                disabled>ğŸ“Š å¯¼å‡º</button>
                        </div>
                    </div>
                </div>

                <!-- TAB 5: MVR (é€å¹³å¼) v8.29 Modified -->
                <div id="tab-content-5" class="tab-content" style="display: none;">
                    <form id="calc-form-5" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                        <div>
                            <h2 class="text-2xl font-semibold text-teal-700 mb-4 border-b pb-2">1. è’¸æ±½ MVR å‚æ•°</h2>
                            <div class="input-group"><label class="text-sm">å·¥è´¨</label><select id="fluid_m5"
                                    name="fluid_m5" class="w-full border-gray-300 rounded px-2 py-1">
                                    <option value="Water">Water (Steam)</option>
                                </select></div>
                            <div class="grid grid-cols-2 gap-x-4 mt-2">
                                <div class="input-group"><label class="text-sm">å¸æ°”å‹åŠ› (bar)</label><input type="number"
                                        name="p_in_m5" value="1.013" step="0.001"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <!-- Changed: T_in -> SH_in -->
                                <div class="input-group"><label class="text-sm font-bold text-teal-800">å¸æ°”è¿‡çƒ­åº¦
                                        (K)</label><input type="number" name="SH_in_m5" value="0" step="0.1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>
                            <div class="input-group mt-2"><label class="text-sm font-bold text-teal-800">é¥±å’Œæ¸©å‡ Î”T
                                    (K)</label><input type="number" name="delta_T_m5" value="8" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                        </div>
                        <div>
                            <h2 class="text-2xl font-semibold text-teal-700 mb-4 border-b pb-2">2. é€å¹³é€‰å‹ & å‡æ¸©</h2>
                            <div class="mb-3">
                                <div class="flex space-x-4 text-sm">
                                    <label><input type="radio" name="flow_mode_m5" value="mass" checked> è´¨é‡æµé‡</label>
                                    <label><input type="radio" name="flow_mode_m5" value="vol"> ä½“ç§¯æµé‡</label>
                                </div>
                            </div>
                            <div id="flow-inputs-mass-m5"><label class="text-sm">è’¸å‘é‡ (kg/h)</label><input type="number"
                                    name="mass_flow_m5" value="5000" step="0.001"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>
                            <div id="flow-inputs-vol-m5" class="hidden"><label class="text-sm">å¸æ°”ä½“ç§¯æµé‡
                                    (mÂ³/h)</label><input type="number" name="vol_flow_m5" value="8000" step="0.01"
                                    class="w-full border-gray-300 rounded px-2 py-1"></div>

                            <div class="input-group bg-blue-50 p-2 rounded border border-blue-200 mt-2">
                                <label class="block text-xs font-bold text-blue-800 mb-1">ğŸ¤– AI æ¨è</label>
                                <select id="ai_eff_m5"
                                    class="block w-full text-sm border-blue-300 rounded text-blue-700">
                                    <option value="">-- é€‰æ‹©æœºå‹ --</option>
                                    <option value="fan">é«˜é€Ÿé£æœº (Poly: 75%)</option>
                                    <option value="centrifugal">å•çº§ç¦»å¿ƒ (Poly: 80%)</option>
                                    <option value="multi_stage">å¤šçº§ç¦»å¿ƒ (Poly: 84%)</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-2 gap-x-4 mt-2">
                                <div class="input-group"><label class="text-sm">å¤šå˜æ•ˆç‡ Polytropic Eff. (%)</label><input
                                        type="number" id="eff_poly_m5" name="eff_poly_m5" value="80" step="0.01"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                                <div class="input-group"><label class="text-sm">çº§æ•° (Stages)</label><input type="number"
                                        name="stages_m5" value="1" step="1" min="1"
                                        class="w-full border-gray-300 rounded px-2 py-1"></div>
                            </div>

                            <div class="mt-4 pt-2 border-t border-gray-200 bg-teal-50 p-2 rounded">
                                <div class="flex items-center mb-2">
                                    <input id="enable_desuperheat_m5" name="enable_desuperheat_m5" type="checkbox"
                                        class="h-4 w-4 text-teal-600" checked>
                                    <label for="enable_desuperheat_m5"
                                        class="ml-2 text-sm font-bold text-teal-900">å¯ç”¨å–·æ°´å‡æ¸© (Desuperheating)</label>
                                </div>
                                <div id="desuperheat-inputs-m5">
                                    <div class="grid grid-cols-2 gap-x-4">
                                        <div class="input-group"><label class="text-xs">å–·æ°´æ¸©åº¦ (Â°C)</label><input
                                                type="number" name="T_water_in_m5" value="30" step="0.01"
                                                class="w-full border-gray-300 rounded px-2 py-1 text-sm"></div>
                                        <div class="input-group"><label class="text-xs">ç›®æ ‡è¿‡çƒ­åº¦ (K)</label><input
                                                type="number" name="target_superheat_m5" value="0" step="0.1"
                                                class="w-full border-gray-300 rounded px-2 py-1 text-sm" title="0è¡¨ç¤ºé¥±å’Œ">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-8"><button type="submit" id="calc-button-5"
                                    class="w-full bg-teal-600 text-white font-bold py-3 rounded hover:bg-teal-700">è®¡ç®—é€å¹³
                                    MVR</button></div>
                        </div>
                    </form>
                    <div class="mt-8">
                        <div id="results-5" class="bg-white border p-4 rounded min-h-[200px]">--- ç»“æœåŒº ---</div>
                        <div id="chart-m5" class="chart-container hidden"></div>
                        <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center">
                            <button type="button" id="print-button-5"
                                class="w-full md:w-auto bg-gray-800 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-gray-900 transition duration-300 flex items-center justify-center gap-2"
                                disabled>ğŸ–¨ï¸ æ‰“å°</button>
                            <button type="button" id="export-button-5"
                                class="w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2"
                                disabled>ğŸ“Š å¯¼å‡º</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="/src/js/libs/coolprop.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggle = (chk, div) => {
                if (chk && div) {
                    const fn = () => div.style.display = chk.checked ? 'block' : 'none';
                    chk.addEventListener('change', fn);
                    fn();
                }
            };
            toggle(document.getElementById('enable_desuperheat_m4'), document.getElementById('desuperheat-inputs-m4'));
            toggle(document.getElementById('enable_desuperheat_m5'), document.getElementById('desuperheat-inputs-m5'));
            toggle(document.getElementById('enable_dynamic_eff_m1'), document.getElementById('dynamic-eff-inputs-m1'));
            toggle(document.getElementById('enable_cooler_calc_m3'), document.getElementById('cooler-inputs-m3'));

            // Mode 2 Cooling
            const coolModeRadio = document.querySelector('input[name="cooling_mode_m2"][value="target_t"]');
            if (coolModeRadio) {
                const coolingInputs = document.getElementById('cooling-inputs-m2');
                const radios = document.querySelectorAll('input[name="cooling_mode_m2"]');
                radios.forEach(r => r.addEventListener('change', () => {
                    coolingInputs.style.display = coolModeRadio.checked ? 'block' : 'none';
                }));
                coolingInputs.style.display = coolModeRadio.checked ? 'block' : 'none';
            }

            // Mode 3 Cooling
            const m3Radios = document.querySelectorAll('input[name="cooling_type_m3"]');
            const updateM3Cooling = () => {
                const val = document.querySelector('input[name="cooling_type_m3"]:checked').value;
                document.getElementById('jacket-inputs-m3').style.display = (val === 'jacket') ? 'block' : 'none';
                document.getElementById('injection-inputs-m3').style.display = (val === 'injection') ? 'block' : 'none';
            };
            m3Radios.forEach(r => r.addEventListener('change', updateM3Cooling));
            updateM3Cooling();
        });
    </script>
</body>

</html>